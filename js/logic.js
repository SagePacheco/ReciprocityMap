function stateFilter(){"use strict";jQuery.each(stateNames,function(e,t){var a="<option>"+t+"</option>";$("#stateFilter").append(a)})}function controlFlow(e){"use strict";currentStateName=e,console.log(currentStateName),""===residentialLicense&&-1===indexCheck(currentStateName,selectedNonResidentialStates)?(console.log("Message Handled"),toggleMessage("ON"),$("#stateMessage").text(currentStateName)):evaluateState(currentStateName),stateFilter()}function evaluateState(){"use strict";var e=indexCheck(currentStateName,allSelectedStates);if(-1===e)if(""!==residentialLicense&&"TRUE"===nonResidenceAccepted(currentStateName))allSelectedStates.push(currentStateName),selectedNonResidentialStates.push(currentStateName);else{if(""!==residentialLicense&&"FALSE"===nonResidenceAccepted(currentStateName))return console.log("There is a residential license, but this state does not accept non-residential licenses"),void alert(currentStateName+" does not accept non-residential licenses. Deselect your residential license or reset the map to use "+currentStateName+" as your residential state.");if(""===residentialLicense&&"TRUE"===nonResidenceAccepted(currentStateName))allSelectedStates.push(currentStateName),selectedNonResidentialStates.push(currentStateName);else if(""===residentialLicense&&"FALSE"===nonResidenceAccepted(currentStateName))return alert(currentStateName+" does not accept non-residential licenses. Though, you may select "+currentStateName+" as your residential licensed state."),void console.log("There is no residential license and this state does not accept non-residential licenses")}else currentStateName===residentialLicense?(console.log("Home State Selected"),numResidentialSelected++,numResidentialSelected>1&&(firstRun=!0,residentialLicense="",numResidentialSelected=0)):(allSelectedStates.splice(e,1),selectedNonResidentialStates.splice(indexCheck(currentStateName,selectedNonResidentialStates),1),console.log("Removing selected state from lists"));var t={residentialLicense:residentialLicense,nonResidentialLicense:selectedNonResidentialStates};t=JSON.stringify(t),acceptedStateRequest(t),triggerStates()}function acceptedStateRequest(e){"use strict";var t="data="+e;t+="&operation=0",$.ajax({data:t,type:"POST",async:!1,url:"php/stateProcessor.php",success:function(e){approvedStates=JSON.parse(e)}})}function nonResidenceAccepted(e){"use strict";var t="clickedState="+e;t+="&operation=1";var a=!0;return $.ajax({data:t,type:"POST",async:!1,url:"php/stateProcessor.php",success:function(e){a=JSON.parse(e)}}),a}function triggerStates(){"use strict";jQuery.each(stateColors,function(e,t){stateColors[e]=denyColor}),jQuery.each(approvedStates,function(e,t){stateColors[indexCheck(t,stateNames)]=acceptColor}),stateColors[indexCheck(residentialLicense,stateNames)]=residentialColor,jQuery.each(selectedNonResidentialStates,function(e,t){stateColors[indexCheck(t,stateNames)]=nonResidentialColor}),jQuery.each(stateNames,function(e,t){controlStates[t].animate({fill:stateColors[e]},250)}),$("#DC").animate({backgroundColor:stateColors[8]},250),informationEngine()}function informationEngine(e){"use strict";var t="",a="",n="";selectedNonResidentialStates.sort(),approvedStates.sort(),$("#residential").text(residentialLicense),jQuery.each(selectedNonResidentialStates,function(e,a){t+=a+", "}),jQuery.each(approvedStates,function(e,t){a+=t+", "}),jQuery.each(stateNames,function(e,t){-1===indexCheck(t,approvedStates)&&-1===indexCheck(t,allSelectedStates)&&(n+=t+", ")}),$("#nonResidential").text(t),$("#permittedStates").text(a),"Reset"!==e&&$("#notPermittedStates").text(n)}function toggleMessage(e){"use strict";"ON"===e?$("#mapMessengerWrapper").fadeIn():$("#mapMessengerWrapper").fadeOut()}function indexCheck(e,t){"use strict";return $.inArray(e,t)}function resetMap(){"use strict";approvedStates=[],allSelectedStates=[],selectedNonResidentialStates=[],residentialLicense="",numResidentialSelected=0,current="",currentStateName="",firstRun=!0,jQuery.each(stateColors,function(e,t){stateColors[e]=neutralColor}),jQuery.each(stateNames,function(e,t){controlStates[t].animate({fill:stateColors[e]},250)}),$("#DC").animate({backgroundColor:neutralColor},250),informationEngine("Reset"),$("#notPermittedStates").text("")}function adminCenter(){"use strict";openAdmin()}function openAdmin(){"use strict";$("#admin").fadeIn(),stateFilter()}function closeAdmin(){"use strict";resetMap(),$("#admin").fadeOut(),$("#stateFilter").empty(),resetMap()}function authenticate(){"use strict";var e="username="+$("#username").val()+"&password="+$("#password").val();e+="&operation=8",$.ajax({data:e,type:"POST",async:!1,url:"php/stateProcessor.php",success:function(e){JSON.parse(e)?($("#credentialArea").fadeOut(),setTimeout(function(){$("#ruleNavigation").fadeIn()},500),$("#adminInformation").text("This screen updates the database that supports this map."),$("#adminSubInformation").text("Select the type of information that you would like to update.")):($("#password").val(""),alert("Your credentials are incorrect. Username and Password are case-sensitive. Please try again."))}})}function adminGrabNonResid(){"use strict";$("#stateFilter").fadeOut();var e="",t="&operation=2";$.ajax({data:t,type:"POST",async:!1,url:"php/stateProcessor.php",success:function(t){e=JSON.parse(t);for(var a="",n="",i=0;i<e.length/2;i++)a+="<tr><td>"+e[i].state+"</td><td class='value'>"+e[i].nonResidentialAllowed+"</td></tr>";for(i;i<e.length;i++)n+="<tr><td>"+e[i].state+"</td><td class='value'>"+e[i].nonResidentialAllowed+"</td></tr>";$("#adminTableLeft").append(a),$("#adminTableRight").append(n),$("#adminContextHeader").text("Non-Residential Issuing States"),$("#adminContextSubHeader").text("Update the rules by clicking on the value. Then click submit."),editableValues(),$("#adminDataWrapper").fadeIn(),$("#commitButton").unbind("click").click(function(){adminPostNonResid()})}})}function adminPostNonResid(){"use strict";var e="operation=3";e+="&data="+dataExtract(),$.ajax({data:e,type:"POST",async:!1,url:"php/stateProcessor.php",success:function(){alert("Your changes have been committed.")}})}function adminGrabNonResidReciprocity(){"use strict";$("#stateFilter").fadeIn();var e="",t="&filteredState="+$("#stateFilter").find("option:selected").val();t+="&operation=4",$.ajax({data:t,type:"POST",async:!1,url:"php/stateProcessor.php",success:function(t){e=JSON.parse(t);for(var a="",n="",i=0;i<e.length/2;i++)a+="<tr><td>"+e[i].reciprocityState+"</td><td class='value'>"+e[i].nonResidentialAcceptance+"</td></tr>";for(i;i<e.length;i++)n+="<tr><td>"+e[i].reciprocityState+"</td><td class='value'>"+e[i].nonResidentialAcceptance+"</td></tr>";$("#adminTableLeft").append(a),$("#adminTableRight").append(n),$("#adminContextHeader").text("Non-Residential Reciprocity Rules for "+e[0].licensedState),$("#adminContextSubHeader").text("Update the rules by clicking on the value. Then click submit."),editableValues(),$("#adminDataWrapper").fadeIn(),$("#stateFilter").unbind("change").change(function(){$("#adminTableLeft").empty(),$("#adminTableRight").empty(),adminGrabNonResidReciprocity()}),$("#commitButton").unbind("click").click(function(){adminPostNonResidReciprocity()})}})}function adminPostNonResidReciprocity(){"use strict";var e="operation=5";e+="&filteredState="+$("#stateFilter").find("option:selected").val(),e+="&data="+dataExtract(),$.ajax({data:e,type:"POST",async:!1,url:"php/stateProcessor.php",success:function(){alert("Your changes have been committed.")}})}function adminGrabReciprocity(){"use strict";$("#stateFilter").fadeIn();var e="",t="&filteredState="+$("#stateFilter").find("option:selected").val();t+="&operation=6",$.ajax({data:t,type:"POST",async:!1,url:"php/stateProcessor.php",success:function(t){e=JSON.parse(t);for(var a="",n="",i=0;i<e.length/2;i++)a+="<tr><td>"+e[i].reciprocityState+"</td><td class='value'>"+e[i].residentialAcceptance+"</td></tr>";for(i;i<e.length;i++)n+="<tr><td>"+e[i].reciprocityState+"</td><td class='value'>"+e[i].residentialAcceptance+"</td></tr>";$("#adminTableLeft").append(a),$("#adminTableRight").append(n),$("#adminContextHeader").text("Reciprocity Rules for "+e[0].licensedState),$("#adminContextSubHeader").text("Update the rules by clicking on the value. Then click submit."),editableValues(),$("#adminDataWrapper").fadeIn(),$("#stateFilter").unbind("change").change(function(){$("#adminTableLeft").empty(),$("#adminTableRight").empty(),adminGrabReciprocity()}),$("#commitButton").unbind("click").click(function(){adminPostReciprocity()})}})}function adminPostReciprocity(){"use strict";var e="operation=7";e+="&filteredState="+$("#stateFilter").find("option:selected").val(),e+="&data="+dataExtract(),$.ajax({data:e,type:"POST",async:!1,url:"php/stateProcessor.php",success:function(){alert("Your changes have been committed.")}})}function editableValues(){"use strict";$(".value").click(function(){"TRUE"===$(this).text()?$(this).text("FALSE").css("background-color","red"):$(this).text("TRUE").css("background-color","green")})}function dataExtract(){"use strict";var e=[];return $("table tr").each(function(){var t=[];$("td",this).each(function(){t.push($(this).text())}),e.push(t)}),JSON.stringify(e)}var approvedStates=[],allSelectedStates=[],selectedNonResidentialStates=[],residentialLicense="",numResidentialSelected=0,currentStateName,firstRun=!0,neutralColor="#58798D",denyColor="#671315",acceptColor="#1f7a1f",residentialColor="#3399ff",nonResidentialColor="#cc6600";$("#colorBlock1").css("background-color",residentialColor),$("#colorBlock2").css("background-color",nonResidentialColor),$("#colorBlock3").css("background-color",acceptColor),$("#colorBlock4").css("background-color",denyColor),$("#DC").css("background-color",neutralColor),$("#credentialForm").submit(function(e){"use strict";e.preventDefault()}),$("#closeButton").click(function(){"use strict";currentStateName="",current="",toggleMessage("OFF")}),$("#resident").click(function(){"use strict";residentialLicense=currentStateName,toggleMessage("OFF"),firstRun=!1,allSelectedStates.push(currentStateName),evaluateState(currentStateName)}),$("#nonResident").click(function(){"use strict";toggleMessage("OFF"),firstRun=!1,evaluateState(currentStateName)}),$("#DC").click(function(){"use strict";controlFlow("District of Columbia")}),$("#resetButton").click(function(){"use strict";resetMap()}),$("#adminButton").click(function(){"use strict";adminCenter()}),$("#closeAdmin").click(function(){"use strict";$("#admin").fadeOut()}),$("#closeAdmin2").click(function(){"use strict";closeAdmin()}),$("#adminNonResidMenuButton").click(function(){"use strict";$("#adminTableLeft").empty(),$("#adminTableRight").empty(),adminGrabNonResid()}),$("#adminNonResidMenuButton2").click(function(){"use strict";$("#adminTableLeft").empty(),$("#adminTableRight").empty(),adminGrabNonResidReciprocity()}),$("#adminRecipMenuButton").click(function(){"use strict";$("#adminTableLeft").empty(),$("#adminTableRight").empty(),adminGrabReciprocity()}),$("#signInButton").click(function(){"use strict";authenticate()});